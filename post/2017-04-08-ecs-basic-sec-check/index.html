<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>阿里云ECS基本安全检查小结 | 沉风网事</title><meta name=keywords content="Secure"><meta name=description content="背景 查看阿里云ECS服务器日志发现如下： 1 2 3 4 5 6 7 type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=&#34;deploy&#34; exe=&#34;/usr/sbin/sshd&#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed' type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28756E6B6E6F776E207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0"><meta name=author content="沉风"><link rel=canonical href=https://myself659.github.io/post/2017-04-08-ecs-basic-sec-check/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css integrity="sha256-v1+fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://myself659.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://myself659.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://myself659.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://myself659.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://myself659.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-144475213-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="阿里云ECS基本安全检查小结"><meta property="og:description" content="背景 查看阿里云ECS服务器日志发现如下： 1 2 3 4 5 6 7 type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=&#34;deploy&#34; exe=&#34;/usr/sbin/sshd&#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed' type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28756E6B6E6F776E207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0"><meta property="og:type" content="article"><meta property="og:url" content="https://myself659.github.io/post/2017-04-08-ecs-basic-sec-check/"><meta property="og:image" content="https://myself659.github.io/"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-04-08T11:58:06+02:00"><meta property="article:modified_time" content="2017-04-08T11:58:06+02:00"><meta property="og:site_name" content="沉风网事"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://myself659.github.io/"><meta name=twitter:title content="阿里云ECS基本安全检查小结"><meta name=twitter:description content="背景 查看阿里云ECS服务器日志发现如下： 1 2 3 4 5 6 7 type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=&#34;deploy&#34; exe=&#34;/usr/sbin/sshd&#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed' type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28756E6B6E6F776E207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://myself659.github.io/post/"},{"@type":"ListItem","position":2,"name":"阿里云ECS基本安全检查小结","item":"https://myself659.github.io/post/2017-04-08-ecs-basic-sec-check/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"阿里云ECS基本安全检查小结","name":"阿里云ECS基本安全检查小结","description":"背景 查看阿里云ECS服务器日志发现如下： 1 2 3 4 5 6 7 type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg=\u0026#39;op=PAM:authentication acct=\u0026#34;deploy\u0026#34; exe=\u0026#34;/usr/sbin/sshd\u0026#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed\u0026#39; type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg=\u0026#39;op=login acct=28696E76616C6964207573657229 exe=\u0026#34;/usr/sbin/sshd\u0026#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed\u0026#39; type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg=\u0026#39;op=login acct=28756E6B6E6F776E207573657229 exe=\u0026#34;/usr/sbin/sshd\u0026#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed\u0026#39; type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0","keywords":["Secure"],"articleBody":"背景 查看阿里云ECS服务器日志发现如下：\n1 2 3 4 5 6 7 type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=\"deploy\" exe=\"/usr/sbin/sshd\" hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed' type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=\"/usr/sbin/sshd\" hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28756E6B6E6F776E207573657229 exe=\"/usr/sbin/sshd\" hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=\"/usr/sbin/sshd\" hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_AUTH msg=audit(1491669589.420:15636): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=\"deploy\" exe=\"/usr/sbin/sshd\" hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed' type=USER_LOGIN msg=audit(1491669589.420:15637): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28696E76616C6964207573657229 exe=\"/usr/sbin/sshd\" hostname=? addr=123.57.245.163 terminal=sshd res=failed' type=USER_LOGIN msg=audit(1491669658.624:15639): pid=22948 uid=0 auid=4294967295 ses=4294967295 msg='op=login acct=28756E6B6E6F776E207573657229 exe=\"/usr/sbin/sshd\" hostname=? addr=123.57.245.163 terminal=sshd res=failed' 百度一下这个ip地址，如下图所示： ![记下这个IP,留下证据](/images/attck ip.png)\n这是有人在阿里云ECS写脚本要暴力破解云主机的密码。这个引起我的注意，赶紧检查一下自己的ECS是否被破解。\n说点题外话：记得去年帮人弄一个网站的时候，后面的她的云主机密码泄漏了，人家第一反应过来就是怀疑我，还得花心思给她解释有多种情况会导致密码泄漏与破解，伤不起啊。\n整个检查大体如下，分为以下几个部分：\n检查有哪些用户？ 用户会干什么？ 用户干过什么？ 处于什么样的环境？ 检查用户 查看当前在线用户 1 root@ecs-1:~# who 为了确定是否当前就有不明用户登录，如果有不明用户登录，那么得赶紧修改密码。\n查看当前ssh连接情况 1 root@ecs-1:~# ss -t sport = :22 查看用户的ssh连接情况，进行对比确认\n查看新增用户 1 root@ecs-1:~# awk -F':' '{ print $1}' /etc/passwd 查看当前用户 1 root@ecs-1:~# awk -F':' '{ print $1}' /etc/passwd 主要是确定是否存在可疑用户，是否有可疑用户加入\n检查是否存在特权用户 1 2 root@ecs-1:~# awk -F: '$3==0 {print $1}' /etc/passwd root 检查用户口令是否为空 1 root@ecs-1:~# awk -F: 'length($2)==0 {print $1}' /etc/shadow 检查用户会干什么 top查看内存与内存使用情况 1 root@ecs-1:~# top 关注高cpu使用率与高内存占用程序，例如比特币的矿机一般会占用大量的cpu资源\n查看任务计划 1 root@ecs-1:~# crontab -l 查看网络连接情况 1 root@ecs-1:~# netstat -natp 检查隐藏进程 检查隐藏进程，三步走：\n第一步：\n1 root@ecs-1:~# ps -ef | awk '{print $2}' | sort -n | uniq \u003e pid1 第二步：\n1 root@ecs-1:~# ls /proc | grep -E '[0-9]{1,}' | sort -n | uniq \u003e pid2 第三步：\n1 2 3 4 5 6 7 8 9 10 11 12 root@ecs-1:~# diff pid1 pid2 1d0 \u003c PID \u003c 29592 \u003c 29593 \u003c 29594 \u003c 29595 --- \u003e 29588 \u003e 29589 \u003e 29590 \u003e 29591 结果说明： 第一步有4个不同的进程表示这条命令对应的进程，第二步同样的，所以这里没有发现隐藏的进程\n检查rcx.d 1 root@ecs-1:~# ls /etc/rc3.d 检查用户干过什么 重点检查以下情况：\n用户登录 机器重启情况 安全日志 历史操作 安全文件检查 用last -d 查看登录情况 1 root@ecs-1:~# last -d 用last -x 查看机器重启情况 1 root@ecs-1:~# last -x reboot 查看audit的log信息 1 root@ecs-1:~# cat /var/log/audit/audit.log 查看历史命令 1 2 3 root@ecs-1:~# history 271 iptables -L 272 package main 安全文件检查 检查授权的ssh key，查看是否有未知的ssh key添加 1 root@ecs-1:~# cat ~/.ssh/authorized_keys 检查bashrc 1 root@ecs-1:~# cat ~/.bashrc 检查密码最后修改时间 1 root@ecs-1:~# ls -l /etc/passwd 环境 网络隔离性 网络采用了VPC网络模式，检测结果如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 root@ecs-1# nmap -v -sT 172.17.11.0/28 --open Starting Nmap 6.40 ( http://nmap.org ) at 2017-03-14 10:23 CST Initiating ARP Ping Scan at 10:23 Scanning 16 hosts [1 port/host] Completed ARP Ping Scan at 10:23, 0.41s elapsed (16 total hosts) Initiating Parallel DNS resolution of 16 hosts. at 10:23 Completed Parallel DNS resolution of 16 hosts. at 10:24, 13.00s elapsed Initiating Connect Scan at 10:24 Scanning 16 hosts [1000 ports/host] Connect Scan Timing: About 2.42% done; ETC: 10:45 (0:20:49 remaining) Connect Scan Timing: About 11.94% done; ETC: 10:46 (0:19:40 remaining) Connect Scan Timing: About 16.72% done; ETC: 10:46 (0:18:31 remaining) Connect Scan Timing: About 21.57% done; ETC: 10:46 (0:17:20 remaining) Connect Scan Timing: About 26.57% done; ETC: 10:46 (0:16:13 remaining) Connect Scan Timing: About 31.72% done; ETC: 10:46 (0:15:06 remaining) Connect Scan Timing: About 37.01% done; ETC: 10:46 (0:13:59 remaining) Connect Scan Timing: About 41.86% done; ETC: 10:46 (0:12:52 remaining) Connect Scan Timing: About 47.34% done; ETC: 10:46 (0:11:45 remaining) Connect Scan Timing: About 52.56% done; ETC: 10:46 (0:10:37 remaining) Connect Scan Timing: About 57.65% done; ETC: 10:46 (0:09:27 remaining) Connect Scan Timing: About 62.67% done; ETC: 10:46 (0:08:19 remaining) Connect Scan Timing: About 67.69% done; ETC: 10:46 (0:07:11 remaining) Connect Scan Timing: About 72.92% done; ETC: 10:46 (0:06:01 remaining) Connect Scan Timing: About 78.18% done; ETC: 10:46 (0:04:51 remaining) Connect Scan Timing: About 83.26% done; ETC: 10:46 (0:03:43 remaining) Connect Scan Timing: About 88.35% done; ETC: 10:46 (0:02:35 remaining) Connect Scan Timing: About 93.58% done; ETC: 10:46 (0:01:25 remaining) Completed Connect Scan against 172.17.11.14 in 1276.55s (15 hosts left) Completed Connect Scan against 172.17.11.7 in 1279.69s (14 hosts left) Completed Connect Scan against 172.17.11.1 in 1280.09s (13 hosts left) Completed Connect Scan against 172.17.11.10 in 1291.35s (12 hosts left) Completed Connect Scan against 172.17.11.12 in 1291.68s (11 hosts left) Completed Connect Scan against 172.17.11.5 in 1322.08s (10 hosts left) Completed Connect Scan against 172.17.11.4 in 1322.13s (9 hosts left) Completed Connect Scan against 172.17.11.15 in 1325.48s (8 hosts left) Completed Connect Scan against 172.17.11.3 in 1328.10s (7 hosts left) Completed Connect Scan against 172.17.11.9 in 1329.43s (6 hosts left) Completed Connect Scan against 172.17.11.11 in 1331.76s (5 hosts left) Completed Connect Scan against 172.17.11.2 in 1335.78s (4 hosts left)) Completed Connect Scan against 172.17.11.0 in 1336.84s (3 hosts leftCompleted Connect Scan against 172.17.11.6 in 1337.46s (2 hosts left) Completed Connect Scan against 172.17.11.8 in 1338.91s (1 host left) Completed Connect Scan at 10:46, 1342.34s elapsed (16000 total ports) Read data files from: /usr/bin/../share/nmap Nmap done: 16 IP addresses (16 hosts up) scanned in 1355.80 seconds Raw packets sent: 16 (448B) | Rcvd: 16 (448B) 如果网络没有隔离，各个VM同一个局域网内，会发现同一个网段的开放的端口，检查结果如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 root@centos# nmap -v -sT 192.168.20.0/24 --open Discovered open port 80/tcp on 192.168.20.10 Discovered open port 3389/tcp on 192.168.20.63 Discovered open port 80/tcp on 192.168.20.38 Discovered open port 135/tcp on 192.168.20.49 Discovered open port 3389/tcp on 192.168.20.52 Discovered open port 80/tcp on 192.168.20.49 Discovered open port 80/tcp on 192.168.20.34 Discovered open port 445/tcp on 192.168.20.37 Discovered open port 445/tcp on 192.168.20.36 Discovered open port 135/tcp on 192.168.20.14 Discovered open port 3389/tcp on 192.168.20.38 Discovered open port 135/tcp on 192.168.20.50 通过对比可知，采用VPC隔离的ECS不能发现同一个网段开放的网络端口，这样安全性也大大增加，好在阿里云ECS已经支持上VPC,这样就不担心来自同一个网段的攻击了（堡垒更容易从内部攻破）\n总结 安全首先是一个意识问题，需要保证足够的敏锐 阿里云的ip基本是一个大段范围，这么多IP对应的ECS肯定有些用户是安全小白用户，这样攻击者的成本也不会很高，写一个脚本遍历这个大的ip池，就可以获取一些小白用户的ECS 密码一定不要用12345678之类或者那些常用的密码，另外注意定时更换密码 对阿里云一个建议：对于暴力破解ssh密码，增加功能实现同一个ip地址多次尝试ssh的限制 这篇主要写一些基本检查操作，有空的时候再写一篇加强基础安全防护的文章 不足与建议，欢迎指正与交流。\n（end）\n参考 Understanding Audit Log Files linux man Hiding Linux Processes For Fun And Profit Linux: Hide Processes From Other Users Understanding Red Hat Run Levels ","wordCount":"1940","inLanguage":"zh","datePublished":"2017-04-08T11:58:06+02:00","dateModified":"2017-04-08T11:58:06+02:00","author":{"@type":"Person","name":"沉风"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://myself659.github.io/post/2017-04-08-ecs-basic-sec-check/"},"publisher":{"@type":"Organization","name":"沉风网事","logo":{"@type":"ImageObject","url":"https://myself659.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://myself659.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://myself659.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://myself659.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://myself659.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://myself659.github.io/search/ title=Search><span>Search</span></a></li><li><a href=https://myself659.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://myself659.github.io/about/ title=About><span>About</span></a></li><li><a href=https://myself659.github.io/post/leetcode/ title=LeetCode><span>LeetCode</span></a></li><li><a href=https://myself659.github.io/post/read-post/ title=Reading><span>Reading</span></a></li><li><a href=https://myself659.github.io/post/share-post/ title=Share><span>Share</span></a></li><li><a href=https://myself659.github.io/post/slide-post/ title=Slide><span>Slide</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://myself659.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://myself659.github.io/post/>Posts</a></div><h1 class=post-title>阿里云ECS基本安全检查小结</h1><div class=post-meta><span title='2017-04-08 11:58:06 +0200 +0200'>2017-04-08</span>&nbsp;·&nbsp;沉风</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><ul><li><a href=#%e8%83%8c%e6%99%af aria-label=背景>背景</a></li></ul><li><a href=#%e6%a3%80%e6%9f%a5%e7%94%a8%e6%88%b7 aria-label=检查用户>检查用户</a><ul><li><a href=#%e6%9f%a5%e7%9c%8b%e5%bd%93%e5%89%8d%e5%9c%a8%e7%ba%bf%e7%94%a8%e6%88%b7 aria-label=查看当前在线用户>查看当前在线用户</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e5%bd%93%e5%89%8dssh%e8%bf%9e%e6%8e%a5%e6%83%85%e5%86%b5 aria-label=查看当前ssh连接情况>查看当前ssh连接情况</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e6%96%b0%e5%a2%9e%e7%94%a8%e6%88%b7 aria-label=查看新增用户>查看新增用户</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e5%bd%93%e5%89%8d%e7%94%a8%e6%88%b7 aria-label=查看当前用户>查看当前用户</a></li><li><a href=#%e6%a3%80%e6%9f%a5%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8%e7%89%b9%e6%9d%83%e7%94%a8%e6%88%b7 aria-label=检查是否存在特权用户>检查是否存在特权用户</a></li><li><a href=#%e6%a3%80%e6%9f%a5%e7%94%a8%e6%88%b7%e5%8f%a3%e4%bb%a4%e6%98%af%e5%90%a6%e4%b8%ba%e7%a9%ba aria-label=检查用户口令是否为空>检查用户口令是否为空</a></li></ul></li><li><a href=#%e6%a3%80%e6%9f%a5%e7%94%a8%e6%88%b7%e4%bc%9a%e5%b9%b2%e4%bb%80%e4%b9%88 aria-label=检查用户会干什么>检查用户会干什么</a><ul><li><a href=#top%e6%9f%a5%e7%9c%8b%e5%86%85%e5%ad%98%e4%b8%8e%e5%86%85%e5%ad%98%e4%bd%bf%e7%94%a8%e6%83%85%e5%86%b5 aria-label=top查看内存与内存使用情况>top查看内存与内存使用情况</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e4%bb%bb%e5%8a%a1%e8%ae%a1%e5%88%92 aria-label=查看任务计划>查看任务计划</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e7%bd%91%e7%bb%9c%e8%bf%9e%e6%8e%a5%e6%83%85%e5%86%b5 aria-label=查看网络连接情况>查看网络连接情况</a></li><li><a href=#%e6%a3%80%e6%9f%a5%e9%9a%90%e8%97%8f%e8%bf%9b%e7%a8%8b aria-label=检查隐藏进程>检查隐藏进程</a></li><li><a href=#%e6%a3%80%e6%9f%a5rcxd aria-label=检查rcx.d>检查rcx.d</a></li></ul></li><li><a href=#%e6%a3%80%e6%9f%a5%e7%94%a8%e6%88%b7%e5%b9%b2%e8%bf%87%e4%bb%80%e4%b9%88 aria-label=检查用户干过什么>检查用户干过什么</a><ul><li><a href=#%e7%94%a8last--d-%e6%9f%a5%e7%9c%8b%e7%99%bb%e5%bd%95%e6%83%85%e5%86%b5 aria-label="用last -d 查看登录情况">用last -d 查看登录情况</a></li><li><a href=#%e7%94%a8last---x-%e6%9f%a5%e7%9c%8b%e6%9c%ba%e5%99%a8%e9%87%8d%e5%90%af%e6%83%85%e5%86%b5 aria-label="用last  -x 查看机器重启情况">用last -x 查看机器重启情况</a></li><li><a href=#%e6%9f%a5%e7%9c%8baudit%e7%9a%84log%e4%bf%a1%e6%81%af aria-label=查看audit的log信息>查看audit的log信息</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e5%8e%86%e5%8f%b2%e5%91%bd%e4%bb%a4 aria-label=查看历史命令>查看历史命令</a></li><li><a href=#%e5%ae%89%e5%85%a8%e6%96%87%e4%bb%b6%e6%a3%80%e6%9f%a5 aria-label=安全文件检查>安全文件检查</a></li></ul></li><li><a href=#%e7%8e%af%e5%a2%83 aria-label=环境>环境</a><ul><li><a href=#%e7%bd%91%e7%bb%9c%e9%9a%94%e7%a6%bb%e6%80%a7 aria-label=网络隔离性>网络隔离性</a></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a><ul><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=背景>背景<a hidden class=anchor aria-hidden=true href=#背景>#</a></h3><p>查看阿里云ECS服务器日志发现如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>type=USER_AUTH msg=audit(1491669519.156:15631): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=PAM:authentication acct=&#34;deploy&#34; exe=&#34;/usr/sbin/sshd&#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_LOGIN msg=audit(1491669519.156:15632): pid=22938 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_LOGIN msg=audit(1491669587.368:15634): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=login acct=28756E6B6E6F776E207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_LOGIN msg=audit(1491669587.368:15635): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_AUTH msg=audit(1491669589.420:15636): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=PAM:authentication acct=&#34;deploy&#34; exe=&#34;/usr/sbin/sshd&#34; hostname=123.57.245.163 addr=123.57.245.163 terminal=ssh res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_LOGIN msg=audit(1491669589.420:15637): pid=22940 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=login acct=28696E76616C6964207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed&#39;
</span></span><span class=line><span class=cl>type=USER_LOGIN msg=audit(1491669658.624:15639): pid=22948 uid=0 auid=4294967295 ses=4294967295 msg=&#39;op=login acct=28756E6B6E6F776E207573657229 exe=&#34;/usr/sbin/sshd&#34; hostname=? addr=123.57.245.163 terminal=sshd res=failed&#39;
</span></span></code></pre></td></tr></table></div></div><p>百度一下这个ip地址，如下图所示：
![记下这个IP,留下证据](/images/attck ip.png)</p><p>这是有人在阿里云ECS写脚本要暴力破解云主机的密码。这个引起我的注意，赶紧检查一下自己的ECS是否被破解。</p><p>说点题外话：记得去年帮人弄一个网站的时候，后面的她的云主机密码泄漏了，人家第一反应过来就是怀疑我，还得花心思给她解释有多种情况会导致密码泄漏与破解，伤不起啊。</p><p>整个检查大体如下，分为以下几个部分：</p><ol><li>检查有哪些用户？</li><li>用户会干什么？</li><li>用户干过什么？</li><li>处于什么样的环境？</li></ol><h2 id=检查用户>检查用户<a hidden class=anchor aria-hidden=true href=#检查用户>#</a></h2><h3 id=查看当前在线用户>查看当前在线用户<a hidden class=anchor aria-hidden=true href=#查看当前在线用户>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# who 
</span></span></code></pre></td></tr></table></div></div><p>为了确定是否当前就有不明用户登录，如果有不明用户登录，那么得赶紧修改密码。</p><h3 id=查看当前ssh连接情况>查看当前ssh连接情况<a hidden class=anchor aria-hidden=true href=#查看当前ssh连接情况>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# ss  -t   sport = :22   
</span></span></code></pre></td></tr></table></div></div><p>查看用户的ssh连接情况，进行对比确认</p><h3 id=查看新增用户>查看新增用户<a hidden class=anchor aria-hidden=true href=#查看新增用户>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# awk -F&#39;:&#39; &#39;{ print $1}&#39; /etc/passwd
</span></span></code></pre></td></tr></table></div></div><h3 id=查看当前用户>查看当前用户<a hidden class=anchor aria-hidden=true href=#查看当前用户>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# awk -F&#39;:&#39; &#39;{ print $1}&#39; /etc/passwd
</span></span></code></pre></td></tr></table></div></div><p>主要是确定是否存在可疑用户，是否有可疑用户加入</p><h3 id=检查是否存在特权用户>检查是否存在特权用户<a hidden class=anchor aria-hidden=true href=#检查是否存在特权用户>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# awk -F: &#39;$3==0 {print $1}&#39; /etc/passwd
</span></span><span class=line><span class=cl>root
</span></span></code></pre></td></tr></table></div></div><h3 id=检查用户口令是否为空>检查用户口令是否为空<a hidden class=anchor aria-hidden=true href=#检查用户口令是否为空>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# awk -F: &#39;length($2)==0 {print $1}&#39; /etc/shadow
</span></span></code></pre></td></tr></table></div></div><h2 id=检查用户会干什么>检查用户会干什么<a hidden class=anchor aria-hidden=true href=#检查用户会干什么>#</a></h2><h3 id=top查看内存与内存使用情况>top查看内存与内存使用情况<a hidden class=anchor aria-hidden=true href=#top查看内存与内存使用情况>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# top  
</span></span></code></pre></td></tr></table></div></div><p>关注高cpu使用率与高内存占用程序，例如比特币的矿机一般会占用大量的cpu资源</p><h3 id=查看任务计划>查看任务计划<a hidden class=anchor aria-hidden=true href=#查看任务计划>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# crontab   -l
</span></span></code></pre></td></tr></table></div></div><h3 id=查看网络连接情况>查看网络连接情况<a hidden class=anchor aria-hidden=true href=#查看网络连接情况>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# netstat   -natp  
</span></span></code></pre></td></tr></table></div></div><h3 id=检查隐藏进程>检查隐藏进程<a hidden class=anchor aria-hidden=true href=#检查隐藏进程>#</a></h3><p>检查隐藏进程，三步走：</p><p>第一步：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# ps  -ef    | awk   &#39;{print $2}&#39;  | sort  -n    |  uniq   &gt; pid1
</span></span></code></pre></td></tr></table></div></div><p>第二步：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# ls   /proc  | grep -E &#39;[0-9]{1,}&#39; | sort   -n    | uniq   &gt; pid2  
</span></span></code></pre></td></tr></table></div></div><p>第三步：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# diff pid1 pid2  
</span></span><span class=line><span class=cl>1d0
</span></span><span class=line><span class=cl>&lt; PID
</span></span><span class=line><span class=cl>&lt; 29592
</span></span><span class=line><span class=cl>&lt; 29593
</span></span><span class=line><span class=cl>&lt; 29594
</span></span><span class=line><span class=cl>&lt; 29595
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>&gt; 29588
</span></span><span class=line><span class=cl>&gt; 29589
</span></span><span class=line><span class=cl>&gt; 29590
</span></span><span class=line><span class=cl>&gt; 29591
</span></span></code></pre></td></tr></table></div></div><p>结果说明： 第一步有4个不同的进程表示这条命令对应的进程，第二步同样的，所以这里没有发现隐藏的进程</p><h3 id=检查rcxd>检查rcx.d<a hidden class=anchor aria-hidden=true href=#检查rcxd>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# ls /etc/rc3.d
</span></span></code></pre></td></tr></table></div></div><h2 id=检查用户干过什么>检查用户干过什么<a hidden class=anchor aria-hidden=true href=#检查用户干过什么>#</a></h2><p>重点检查以下情况：</p><ol><li>用户登录</li><li>机器重启情况</li><li>安全日志</li><li>历史操作</li><li>安全文件检查</li></ol><h3 id=用last--d-查看登录情况>用last -d 查看登录情况<a hidden class=anchor aria-hidden=true href=#用last--d-查看登录情况>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# last   -d  
</span></span></code></pre></td></tr></table></div></div><h3 id=用last---x-查看机器重启情况>用last -x 查看机器重启情况<a hidden class=anchor aria-hidden=true href=#用last---x-查看机器重启情况>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# last   -x reboot  
</span></span></code></pre></td></tr></table></div></div><h3 id=查看audit的log信息>查看audit的log信息<a hidden class=anchor aria-hidden=true href=#查看audit的log信息>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# cat   /var/log/audit/audit.log  
</span></span></code></pre></td></tr></table></div></div><h3 id=查看历史命令>查看历史命令<a hidden class=anchor aria-hidden=true href=#查看历史命令>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>root</span><span class=err>@</span><span class=nx>ecs</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span><span class=err>~#</span> <span class=nx>history</span>    
</span></span><span class=line><span class=cl>  <span class=mi>271</span>  <span class=nx>iptables</span>   <span class=o>-</span><span class=nx>L</span>
</span></span><span class=line><span class=cl>  <span class=mi>272</span>  <span class=kn>package</span> <span class=nx>main</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=安全文件检查>安全文件检查<a hidden class=anchor aria-hidden=true href=#安全文件检查>#</a></h3><ol><li>检查授权的ssh key，查看是否有未知的ssh key添加</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~#  cat   ~/.ssh/authorized_keys       
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>检查bashrc</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~#  cat   ~/.bashrc      
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>检查密码最后修改时间</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1:~# ls -l /etc/passwd
</span></span></code></pre></td></tr></table></div></div><h2 id=环境>环境<a hidden class=anchor aria-hidden=true href=#环境>#</a></h2><h3 id=网络隔离性>网络隔离性<a hidden class=anchor aria-hidden=true href=#网络隔离性>#</a></h3><p>网络采用了VPC网络模式，检测结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span><span class=lnt id=hl-21-36><a class=lnlinks href=#hl-21-36>36</a>
</span><span class=lnt id=hl-21-37><a class=lnlinks href=#hl-21-37>37</a>
</span><span class=lnt id=hl-21-38><a class=lnlinks href=#hl-21-38>38</a>
</span><span class=lnt id=hl-21-39><a class=lnlinks href=#hl-21-39>39</a>
</span><span class=lnt id=hl-21-40><a class=lnlinks href=#hl-21-40>40</a>
</span><span class=lnt id=hl-21-41><a class=lnlinks href=#hl-21-41>41</a>
</span><span class=lnt id=hl-21-42><a class=lnlinks href=#hl-21-42>42</a>
</span><span class=lnt id=hl-21-43><a class=lnlinks href=#hl-21-43>43</a>
</span><span class=lnt id=hl-21-44><a class=lnlinks href=#hl-21-44>44</a>
</span><span class=lnt id=hl-21-45><a class=lnlinks href=#hl-21-45>45</a>
</span><span class=lnt id=hl-21-46><a class=lnlinks href=#hl-21-46>46</a>
</span><span class=lnt id=hl-21-47><a class=lnlinks href=#hl-21-47>47</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@ecs-1#  nmap -v -sT 172.17.11.0/28   --open
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 6.40 ( http://nmap.org ) at 2017-03-14 10:23 CST
</span></span><span class=line><span class=cl>Initiating ARP Ping Scan at 10:23
</span></span><span class=line><span class=cl>Scanning 16 hosts [1 port/host]
</span></span><span class=line><span class=cl>Completed ARP Ping Scan at 10:23, 0.41s elapsed (16 total hosts)
</span></span><span class=line><span class=cl>Initiating Parallel DNS resolution of 16 hosts. at 10:23
</span></span><span class=line><span class=cl>Completed Parallel DNS resolution of 16 hosts. at 10:24, 13.00s elapsed
</span></span><span class=line><span class=cl>Initiating Connect Scan at 10:24
</span></span><span class=line><span class=cl>Scanning 16 hosts [1000 ports/host]
</span></span><span class=line><span class=cl>Connect Scan Timing: About 2.42% done; ETC: 10:45 (0:20:49 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 11.94% done; ETC: 10:46 (0:19:40 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 16.72% done; ETC: 10:46 (0:18:31 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 21.57% done; ETC: 10:46 (0:17:20 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 26.57% done; ETC: 10:46 (0:16:13 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 31.72% done; ETC: 10:46 (0:15:06 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 37.01% done; ETC: 10:46 (0:13:59 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 41.86% done; ETC: 10:46 (0:12:52 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 47.34% done; ETC: 10:46 (0:11:45 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 52.56% done; ETC: 10:46 (0:10:37 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 57.65% done; ETC: 10:46 (0:09:27 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 62.67% done; ETC: 10:46 (0:08:19 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 67.69% done; ETC: 10:46 (0:07:11 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 72.92% done; ETC: 10:46 (0:06:01 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 78.18% done; ETC: 10:46 (0:04:51 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 83.26% done; ETC: 10:46 (0:03:43 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 88.35% done; ETC: 10:46 (0:02:35 remaining)
</span></span><span class=line><span class=cl>Connect Scan Timing: About 93.58% done; ETC: 10:46 (0:01:25 remaining)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.14 in 1276.55s (15 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.7 in 1279.69s (14 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.1 in 1280.09s (13 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.10 in 1291.35s (12 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.12 in 1291.68s (11 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.5 in 1322.08s (10 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.4 in 1322.13s (9 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.15 in 1325.48s (8 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.3 in 1328.10s (7 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.9 in 1329.43s (6 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.11 in 1331.76s (5 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.2 in 1335.78s (4 hosts left))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.0 in 1336.84s (3 hosts leftCompleted Connect Scan against 172.17.11.6 in 1337.46s (2 hosts left)
</span></span><span class=line><span class=cl>Completed Connect Scan against 172.17.11.8 in 1338.91s (1 host left)
</span></span><span class=line><span class=cl>Completed Connect Scan at 10:46, 1342.34s elapsed (16000 total ports)
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Nmap done: 16 IP addresses (16 hosts up) scanned in 1355.80 seconds
</span></span><span class=line><span class=cl>           Raw packets sent: 16 (448B) | Rcvd: 16 (448B)
</span></span></code></pre></td></tr></table></div></div><p>如果网络没有隔离，各个VM同一个局域网内，会发现同一个网段的开放的端口，检查结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@centos# nmap   -v -sT  192.168.20.0/24 --open 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.20.10
</span></span><span class=line><span class=cl>Discovered open port 3389/tcp on 192.168.20.63
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.20.38
</span></span><span class=line><span class=cl>Discovered open port 135/tcp on 192.168.20.49
</span></span><span class=line><span class=cl>Discovered open port 3389/tcp on 192.168.20.52
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.20.49
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.20.34
</span></span><span class=line><span class=cl>Discovered open port 445/tcp on 192.168.20.37
</span></span><span class=line><span class=cl>Discovered open port 445/tcp on 192.168.20.36
</span></span><span class=line><span class=cl>Discovered open port 135/tcp on 192.168.20.14
</span></span><span class=line><span class=cl>Discovered open port 3389/tcp on 192.168.20.38
</span></span><span class=line><span class=cl>Discovered open port 135/tcp on 192.168.20.50
</span></span></code></pre></td></tr></table></div></div><p>通过对比可知，采用VPC隔离的ECS不能发现同一个网段开放的网络端口，这样安全性也大大增加，好在阿里云ECS已经支持上VPC,这样就不担心来自同一个网段的攻击了（堡垒更容易从内部攻破）</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><ol><li>安全首先是一个意识问题，需要保证足够的敏锐</li><li>阿里云的ip基本是一个大段范围，这么多IP对应的ECS肯定有些用户是安全小白用户，这样攻击者的成本也不会很高，写一个脚本遍历这个大的ip池，就可以获取一些小白用户的ECS</li><li>密码一定不要用12345678之类或者那些常用的密码，另外注意定时更换密码</li><li>对阿里云一个建议：对于暴力破解ssh密码，增加功能实现同一个ip地址多次尝试ssh的限制</li><li>这篇主要写一些基本检查操作，有空的时候再写一篇加强基础安全防护的文章</li></ol><p>不足与建议，欢迎指正与交流。</p><p>（end）</p><h3 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h3><ol><li><a href=https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sec-Understanding_Audit_Log_Files.html>Understanding Audit Log Files</a></li><li>linux man</li><li><a href=https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/>Hiding Linux Processes For Fun And Profit</a></li><li><a href=https://www.cyberciti.biz/faq/linux-hide-processes-from-other-users/>Linux: Hide Processes From Other Users</a></li><li><a href=http://www.linuxjournal.com/article/1274>Understanding Red Hat Run Levels</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://myself659.github.io/tags/secure/>Secure</a></li></ul><nav class=paginav><a class=prev href=https://myself659.github.io/post/life/what-is-matter-%E9%87%8D%E8%A6%81/><span class=title>« 上一页</span><br><span>什么才是重要的</span></a>
<a class=next href=https://myself659.github.io/post/2017-04-29-about-system-design/><span class=title>下一页 »</span><br><span>对于系统设计的一些想法</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on twitter" href="https://twitter.com/intent/tweet/?text=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93&amp;url=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f&amp;hashtags=Secure"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f&amp;title=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93&amp;summary=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93&amp;source=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f&title=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on whatsapp" href="https://api.whatsapp.com/send?text=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93%20-%20https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 阿里云ECS基本安全检查小结 on telegram" href="https://telegram.me/share/url?text=%e9%98%bf%e9%87%8c%e4%ba%91ECS%e5%9f%ba%e6%9c%ac%e5%ae%89%e5%85%a8%e6%a3%80%e6%9f%a5%e5%b0%8f%e7%bb%93&amp;url=https%3a%2f%2fmyself659.github.io%2fpost%2f2017-04-08-ecs-basic-sec-check%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>comments</span><br></div><div id=tcomment></div><script src=https://utteranc.es/client.js repo=https://github.com/myself659/ipds-public issue-term=title theme=github-light crossorigin=anonymous async></script></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://myself659.github.io/>沉风网事</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>